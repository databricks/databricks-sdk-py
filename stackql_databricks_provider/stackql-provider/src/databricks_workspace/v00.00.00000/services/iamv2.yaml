openapi: 3.0.0
info:
  title: Databricks Iamv2 API (workspace)
  description: OpenAPI specification for the Databricks iamv2 service (workspace-level APIs), generated from the Databricks
    Python SDK.
  version: 0.1.0
  x-stackql-sdk-version: 0.86.0
  x-stackql-date-generated: '2026-02-24'
  x-stackql-sdk-namespace: databricks.sdk.service.iamv2
servers:
- url: https://{workspace}.cloud.databricks.com
  description: Databricks workspace
  variables:
    workspace:
      default: your-workspace
      description: Your Databricks workspace name
paths:
  /api/2.0/identity/workspaceAccessDetails/{principal_id}:
    get:
      operationId: workspace_iam_v2_get_workspace_access_detail_local
      summary: Returns the access details for a principal in the current workspace. Allows for checking access
      tags:
      - iamv2
      - workspace_iam_v2
      description: |-
        Returns the access details for a principal in the current workspace. Allows for checking access
        details for any provisioned principal (user, service principal, or group) in the current workspace. *
        Provisioned principal here refers to one that has been synced into Databricks from the customer's IdP
        or added explicitly to Databricks via SCIM/UI. Allows for passing in a "view" parameter to control
        what fields are returned (BASIC by default or FULL).

        :param principal_id: int
          Required. The internal ID of the principal (user/sp/group) for which the access details are being
          requested.
        :param view: :class:`WorkspaceAccessDetailView` (optional)
          Controls what fields are returned.

        :returns: :class:`WorkspaceAccessDetail`
      parameters:
      - name: principal_id
        in: path
        required: true
        schema:
          type: integer
        description: Required. The internal ID of the principal (user/sp/group) for which the access details are being requested.
      - name: view
        in: query
        required: false
        schema:
          $ref: '#/components/schemas/WorkspaceAccessDetailView'
        description: Controls what fields are returned.
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/WorkspaceAccessDetail'
        default:
          description: Error response
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
      x-stackql-sdk-source: WorkspaceIamV2API
  /api/2.0/identity/groups/resolveByExternalId:
    post:
      operationId: workspace_iam_v2_resolve_group_proxy
      summary: Resolves a group with the given external ID from the customer's IdP. If the group does not exist, it
      tags:
      - iamv2
      - workspace_iam_v2
      description: |-
        Resolves a group with the given external ID from the customer's IdP. If the group does not exist, it
        will be created in the account. If the customer is not onboarded onto Automatic Identity Management
        (AIM), this will return an error.

        :param external_id: str
          Required. The external ID of the group in the customer's IdP.

        :returns: :class:`ResolveGroupResponse`
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                external_id:
                  type: string
                  description: Required. The external ID of the group in the customer's IdP.
              required:
              - external_id
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResolveGroupResponse'
        default:
          description: Error response
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
      x-stackql-sdk-source: WorkspaceIamV2API
  /api/2.0/identity/servicePrincipals/resolveByExternalId:
    post:
      operationId: workspace_iam_v2_resolve_service_principal_proxy
      summary: Resolves an SP with the given external ID from the customer's IdP. If the SP does not exist, it will
      tags:
      - iamv2
      - workspace_iam_v2
      description: |-
        Resolves an SP with the given external ID from the customer's IdP. If the SP does not exist, it will
        be created. If the customer is not onboarded onto Automatic Identity Management (AIM), this will
        return an error.

        :param external_id: str
          Required. The external ID of the service principal in the customer's IdP.

        :returns: :class:`ResolveServicePrincipalResponse`
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                external_id:
                  type: string
                  description: Required. The external ID of the service principal in the customer's IdP.
              required:
              - external_id
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResolveServicePrincipalResponse'
        default:
          description: Error response
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
      x-stackql-sdk-source: WorkspaceIamV2API
  /api/2.0/identity/users/resolveByExternalId:
    post:
      operationId: workspace_iam_v2_resolve_user_proxy
      summary: Resolves a user with the given external ID from the customer's IdP. If the user does not exist, it
      tags:
      - iamv2
      - workspace_iam_v2
      description: |-
        Resolves a user with the given external ID from the customer's IdP. If the user does not exist, it
        will be created. If the customer is not onboarded onto Automatic Identity Management (AIM), this will
        return an error.

        :param external_id: str
          Required. The external ID of the user in the customer's IdP.

        :returns: :class:`ResolveUserResponse`
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                external_id:
                  type: string
                  description: Required. The external ID of the user in the customer's IdP.
              required:
              - external_id
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ResolveUserResponse'
        default:
          description: Error response
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                  message:
                    type: string
      x-stackql-sdk-source: WorkspaceIamV2API
components:
  schemas:
    Group:
      type: object
      properties:
        account_id:
          type: string
          description: The parent account ID for group in Databricks.
        external_id:
          type: string
          description: ExternalId of the group in the customer's IdP.
        group_name:
          type: string
          description: Display name of the group.
        internal_id:
          type: integer
          description: Internal group ID of the group in Databricks.
      description: The details of a Group resource.
    ResolveGroupResponse:
      type: object
      properties:
        group:
          $ref: '#/components/schemas/Group'
    ResolveServicePrincipalResponse:
      type: object
      properties:
        service_principal:
          $ref: '#/components/schemas/ServicePrincipal'
    ResolveUserResponse:
      type: object
      properties:
        user:
          $ref: '#/components/schemas/User'
    ServicePrincipal:
      type: object
      properties:
        account_id:
          type: string
          description: The parent account ID for the service principal in Databricks.
        account_sp_status:
          $ref: '#/components/schemas/State'
          description: The activity status of a service principal in a Databricks account.
        application_id:
          type: string
          description: Application ID of the service principal.
        display_name:
          type: string
          description: Display name of the service principal.
        external_id:
          type: string
          description: ExternalId of the service principal in the customer's IdP.
        internal_id:
          type: integer
          description: Internal service principal ID of the service principal in Databricks.
      description: The details of a ServicePrincipal resource.
    User:
      type: object
      properties:
        account_id:
          type: string
          description: The accountId parent of the user in Databricks.
        account_user_status:
          $ref: '#/components/schemas/State'
          description: The activity status of a user in a Databricks account.
        external_id:
          type: string
          description: ExternalId of the user in the customer's IdP.
        internal_id:
          type: integer
          description: Internal userId of the user in Databricks.
        name:
          $ref: '#/components/schemas/UserName'
        username:
          type: string
          description: Username/email of the user.
      description: The details of a User resource.
    UserName:
      type: object
      properties:
        family_name:
          type: string
        given_name:
          type: string
    WorkspaceAccessDetail:
      type: object
      properties:
        access_type:
          $ref: '#/components/schemas/WorkspaceAccessDetailAccessType'
        account_id:
          type: string
          description: The account ID parent of the workspace where the principal has access.
        permissions:
          type: array
          items:
            $ref: '#/components/schemas/WorkspacePermission'
          description: The permissions granted to the principal in the workspace.
        principal_id:
          type: integer
          description: The internal ID of the principal (user/sp/group) in Databricks.
        principal_type:
          $ref: '#/components/schemas/PrincipalType'
        status:
          $ref: '#/components/schemas/State'
          description: The activity status of the principal in the workspace. Not applicable for groups at the moment.
        workspace_id:
          type: integer
          description: The workspace ID where the principal has access.
      description: The details of a principal's access to a workspace.
    PrincipalType:
      type: string
      x-enum:
      - GROUP
      - SERVICE_PRINCIPAL
      - USER
      description: The type of the principal (user/sp/group).
    State:
      type: string
      x-enum:
      - ACTIVE
      - INACTIVE
      description: The activity status of a user or service principal in a Databricks account or workspace.
    WorkspaceAccessDetailAccessType:
      type: string
      x-enum:
      - DIRECT
      - INDIRECT
      description: The type of access the principal has to the workspace.
    WorkspaceAccessDetailView:
      type: string
      x-enum:
      - BASIC
      - FULL
      description: Controls what fields are returned in the GetWorkspaceAccessDetail response.
    WorkspacePermission:
      type: string
      x-enum:
      - ADMIN_PERMISSION
      - USER_PERMISSION
      description: The type of permission a principal has to a workspace (admin/user).
  x-stackQL-resources:
    workspace_iam_v2:
      id: databricks_workspace.iamv2.workspace_iam_v2
      name: workspace_iam_v2
      title: Workspace Iam V2
      methods:
        get_workspace_access_detail_local:
          operation:
            $ref: '#/paths/~1api~12.0~1identity~1workspaceAccessDetails~1{principal_id}/get'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        resolve_group_proxy:
          config:
            requestBodyTranslate:
              algorithm: naive
          operation:
            $ref: '#/paths/~1api~12.0~1identity~1groups~1resolveByExternalId/post'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        resolve_service_principal_proxy:
          config:
            requestBodyTranslate:
              algorithm: naive
          operation:
            $ref: '#/paths/~1api~12.0~1identity~1servicePrincipals~1resolveByExternalId/post'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
        resolve_user_proxy:
          config:
            requestBodyTranslate:
              algorithm: naive
          operation:
            $ref: '#/paths/~1api~12.0~1identity~1users~1resolveByExternalId/post'
          response:
            mediaType: application/json
            openAPIDocKey: '200'
      sqlVerbs:
        select:
        - $ref: '#/components/x-stackQL-resources/workspace_iam_v2/methods/get_workspace_access_detail_local'
        insert: []
        update: []
        delete: []
        replace: []
    vw_workspace_access_details:
      name: vw_workspace_access_details
      id: databricks_workspace.iamv2.vw_workspace_access_details
      config:
        docs:
          fields:
          - name: deployment_name
            type: string
            description: Workspace deployment name used to scope the query.
          - name: principal_id
            type: string
            description: Unique identifier of the principal whose workspace access is being queried.
          - name: principal_type
            type: string
            description: Type of the principal (e.g. USER, GROUP, SERVICE_PRINCIPAL).
          - name: access_type
            type: string
            description: How the principal was granted access to the workspace (e.g. DIRECT, ACCOUNT_ADMIN).
          - name: status
            type: string
            description: Current access status of the principal on the workspace (e.g. ACTIVE).
          - name: account_id
            type: string
            description: Databricks account ID that owns the workspace.
          - name: workspace_id
            type: integer
            description: Numeric identifier of the workspace.
          - name: permission
            type: string
            description: Permission level granted to the principal on the workspace (one row per permission, e.g. USER, ADMIN).
          requiredParams:
          - name: deployment_name
            type: string
            description: Workspace deployment name used to scope the query.
          - name: principal_id
            type: string
            description: Unique identifier of the principal whose workspace access is being queried.
        views:
          select:
            predicate: sqlDialect == "sqlite3"
            ddl: |-
              SELECT
                wa.deployment_name,
                wa.principal_id,
                wa.principal_type,
                wa.access_type,
                wa.status,
                wa.account_id,
                wa.workspace_id,
                p.value AS permission
              FROM databricks_workspace.iamv2.workspace_iam_v2 wa,
                   JSON_EACH(wa.permissions) p
              WHERE wa.deployment_name = '{{ deployment_name }}'
              AND wa.principal_id = '{{ principal_id }}'
            fallback:
              predicate: sqlDialect == "postgres"
              ddl: |-
                SELECT
                  wa.deployment_name,
                  wa.principal_id,
                  wa.principal_type,
                  wa.access_type,
                  wa.status,
                  wa.account_id,
                  wa.workspace_id,
                  p.value AS permission
                FROM databricks_workspace.iamv2.workspace_iam_v2 wa,
                     jsonb_array_elements(wa.permissions::jsonb) AS p
                WHERE wa.deployment_name = '{{ deployment_name }}'
                AND wa.principal_id = '{{ principal_id }}'
x-stackQL-config:
  pagination:
    requestToken:
      key: page_token
      location: query
    responseToken:
      key: next_page_token
      location: body
